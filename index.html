<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>

	<style>
		.container {
			display: flex;
			flex-direction: column;
			align-items: center;
			row-gap: 32px;
			padding-top: 160px;
			height: 100vh;
		}
		.authorize-app {
			text-decoration: none;
			background-color: #faa107;
			width: 200px;
			height: 48px;
			border-radius: 8px;
			color: white;
			font-size: large;
			font-weight: bold;
			display: flex;
			justify-content: center;
			align-items: center;
			padding: 4px;
		}
	</style>
</head>
<body>
	<div class="container">
		<a class="authorize-app" href="laostravel://app">Continue</a>
	</div>
</body>

<script>
	// const clientUrl ='http://183.182.118.64:8045/auth/login' //server client 
	// const clientUrl ='http://localhost:5000/auth/login' //local client 
	const clientUrl ='https://laotravel.la:8045/auth/login' //domain client 
	const urlParams = new URLSearchParams(window.location.search);
	const authorizationCode = urlParams.get('authorization_code');
	if (authorizationCode) {
		const link = document.querySelector('a.authorize-app');
		if (link) {	
			const deviceType = detectDeviceSmart();	
			if(deviceType === 'desktop') {
				link.href = `${clientUrl}/auth/login?authorization_code=${encodeURIComponent(authorizationCode)}`;
			} else {
				link.href = `laostravel://app/authorize?authorization_code=${encodeURIComponent(authorizationCode)}`;
			}
		
		}


	}

	function detectDeviceSmart() {
    const ua = navigator.userAgent;
    const isMobileUA = /Mobi|Android|iPhone|iPad|iPod/i.test(ua);
	// kiểm tra bằng kích thước màn hình
    // const isSmallScreen = window.innerWidth <= 768;
	// if (isMobileUA || isSmallScreen) {

    if (isMobileUA) {
      return "mobile";
    } else {
      return "desktop";
    }
  }

	window.addEventListener('load', () => {
			const link = document.querySelector('a.authorize-app');
			if (link && link.href) {
				setTimeout(() => {
					link.click();
				}, 300);
			}
		});
</script>
</html>
